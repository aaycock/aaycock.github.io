<html>
<body>
  <div>
    <h1>Your favorite tech company is:</h1>
    <div>
      <img id="logo" style="max-width:150px;height:auto" />
    </div>
  </div>
</body>
<script>
  /* NOTE: delete any comments below surrouded by multi-line comments such as this */

  var companyLogos = {
    facebook: 'images/facebook.jpeg',
    useriq: 'images/useriq.png'
  }

  CompanySelector = function() {
    this.logo = 'ZmFjZWJvb2soKQ==';

    /* decode example desired input = `dXNlcmlxX18=` (decoded = `useriq__`) */
    this.decodeString = function(encodedText) {
      var decoded = EncodingLibrary.decode(encodedText)
      return decoded.substring(0,decoded.length-2)
    }
  }

  CompanySelector.prototype.confirmCheck = function(key, settings) {
    // Make sure we don't include the normal '?' in the settings
    /* obviously the '?' is typically in the query string, not the hash */
    var settings = settings.substring(1).split('&')
    while (settings.length && !key) {

    }
  }

  cs = new CompanySelector()
  logo = cs.decodeString(cs.logo)
  document.getElementById('logo').src = companyLogos[logo]

  // RFC 4648
  var EncodingLibrary = {
    // private property
    _keyStr : "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",

    // public method for decoding
    decode : function (input) {
      var output = "";
      var chr1, chr2, chr3;
      var enc1, enc2, enc3, enc4;
      var i = 0;

      input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");

      while (i < input.length) {

        enc1 = this._keyStr.indexOf(input.charAt(i++));
        enc2 = this._keyStr.indexOf(input.charAt(i++));
        enc3 = this._keyStr.indexOf(input.charAt(i++));
        enc4 = this._keyStr.indexOf(input.charAt(i++));

        chr1 = (enc1 << 2) | (enc2 >> 4);
        chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
        chr3 = ((enc3 & 3) << 6) | enc4;

        output = output + String.fromCharCode(chr1);

        if (enc3 != 64) {
          output = output + String.fromCharCode(chr2);
        }
        if (enc4 != 64) {
          output = output + String.fromCharCode(chr3);
        }

      }

      output = EncodingLibrary._utf8_decode(output);
      return output;

    },

    // private method for UTF-8 encoding
    _utf8_encode : function (string) {
      string = string.replace(/\r\n/g,"\n");
      var utftext = "";

      for (var n = 0; n < string.length; n++) {

        var c = string.charCodeAt(n);

        if (c < 128) {
          utftext += String.fromCharCode(c);
        }
        else if((c > 127) && (c < 2048)) {
          utftext += String.fromCharCode((c >> 6) | 192);
          utftext += String.fromCharCode((c & 63) | 128);
        }
        else {
          utftext += String.fromCharCode((c >> 12) | 224);
          utftext += String.fromCharCode(((c >> 6) & 63) | 128);
          utftext += String.fromCharCode((c & 63) | 128);
        }

      }

      return utftext;
    },

    // private method for UTF-8 decoding
    _utf8_decode : function (utftext) {
      var string = "";
      var i = 0;
      var c = c1 = c2 = 0;
      while ( i < utftext.length ) {
        c = utftext.charCodeAt(i);
        if (c < 128) {
          string += String.fromCharCode(c);
          i++;
        }
        else if((c > 191) && (c < 224)) {
          c2 = utftext.charCodeAt(i+1);
          string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));
          i += 2;
        }
        else {
          c2 = utftext.charCodeAt(i+1);
          c3 = utftext.charCodeAt(i+2);
          string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
          i += 3;
        }
      }
      return string;
    }
  }

  // *****************************************
  // DELETE: TACO CHALLENGE
  // levelMap = {
  //   'easy': 1,
  //   'medium': .1,
  //   'hard': .001
  // }
  //
  // getSetting = function(key, settings) {
  //   settings = settings.split("&")
  //   for(i = 0; i<settings.length; i++){
  //     setting = settings[i];
  //     // Make sure there isn't weird stuff in the settings, if it's longer
  //     // than we want just ignore it
  //     if(setting.length <= 'level=medium'.length) {
  //       if(setting.indexOf(key)) {
  //         return setting.substr(setting.indexOf(key) + key.length + 1);
  //       }
  //     }
  //   }
  //   return 'hard';
  // }
  //
  // validate = function(name, checksum) {
  //   var string = name + "approved by Taco";
  //   var testsum = 123;
  //
  //   for(var i = 0; i<string.length; i++) {
  //     testsum = testsum * 13 + string.charCodeAt(i);
  //     while(testsum > 10000000) {
  //       testsum -= 1000000;
  //     }
  //   }
  //
  //   return testsum == checksum;
  // }
  //
  // checksum = 'NOT APPROVED';
  //
  // // Run until we've processed the whole hash
  // while(location.hash.length > 1 && !name) {
  //   entries = location.hash.split('|');
  //   for(i = 0; i<entries.length; i++) {
  //     parts = entries[i].split('=');
  //     name = decodeURIComponent(parts[0]);
  //     value = decodeURIComponent(parts[1]);
  //     if(name == 'checksum') {
  //       checksum = value;
  //     }
  //   }
  // }
  //
  // level = getSetting('level', window.location.search || '?level=hard');
  // if(!levelMap[level]) {
  //   level = 'medium';
  // }
  //
  // CandidateChooser = {
  //   name: "Taco Spolsky",
  //   recommend: function(e) {
  //     if(e.target.id != 'choose') {
  //       return;
  //     }
  //
  //     random = Math.random();
  //     if(random < levelMap[level]) {
  //       this.name = "Taco Spolsky";
  //     } else if(random > levelMap[level]) {
  //       this.name = "Taco Spolsky";
  //     } else if(random == levelMap[level]) {
  //       this.name = "Taco Spolsky";
  //     }
  //
  //     // This was code used for the demo
  //     // this.name = "Joel Spolsky";
  //
  //     if(this.name != "Taco Spolsky") {
  //       if(!validate(this.name, checksum)) {
  //         this.name = "Taco Spolsky";
  //       }
  //     }
  //     document.getElementById('candidate').textContent = this.name;
  //   }
  // }
  //
  // window.addEventListener('click', CandidateChooser.recommend);
  // *****************************************
</script>
</html>
